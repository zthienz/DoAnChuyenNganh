<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý yêu cầu hỗ trợ - GOOJODOQ Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/admin.css" rel="stylesheet">
    <style>
        .btn-group .btn {
            margin-right: 2px;
        }
        .btn-group .btn:last-child {
            margin-right: 0;
        }
        .notification-toast {
            animation: slideInRight 0.3s ease-out;
        }
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        .table td {
            vertical-align: middle;
        }
        .status-buttons {
            white-space: nowrap;
        }
    </style>
</head>

<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <a href="index.html" class="admin-logo" style="text-decoration: none; color: inherit; cursor: pointer;">
                <img src="images/logo.png" alt="GOOJODOQ">
                <h4>Administrator</h4>
            </a>

            <nav class="admin-nav">
                <a href="admin-dashboard.html" class="nav-item">
                    <i class="fas fa-cog"></i>
                    <span>Quản trị hệ thống</span>
                </a>
                <a href="admin-customers.html" class="nav-item">
                    <i class="fas fa-users"></i>
                    <span>Quản lý khách hàng</span>
                </a>
                <a href="admin-orders.html" class="nav-item">
                    <i class="fas fa-shopping-bag"></i>
                    <span>Quản lý đơn hàng</span>
                </a>
                <a href="admin-products.html" class="nav-item">
                    <i class="fas fa-box"></i>
                    <span>Quản lý sản phẩm</span>
                </a>
                <a href="admin-vouchers.html" class="nav-item">
                    <i class="fas fa-tags"></i>
                    <span>Quản lý mã giảm giá</span>
                </a>
                <a href="admin-statistics.html" class="nav-item">
                    <i class="fas fa-chart-bar"></i>
                    <span>Thống kê sản phẩm</span>
                </a>
                <a href="admin-revenue.html" class="nav-item">
                    <i class="fas fa-chart-line"></i>
                    <span>Tổng doanh thu</span>
                </a>
                <a href="admin-support.html" class="nav-item active">
                    <i class="fas fa-headset"></i>
                    <span>Yêu cầu hỗ trợ</span>
                </a>
                <a href="index.html" class="nav-item">
                    <i class="fas fa-home"></i>
                    <span>Xem trang chủ</span>
                </a>
                <a href="#" class="nav-item" onclick="logoutAdmin(); return false;">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Đăng xuất</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <!-- Header -->
            <header class="admin-header">
                <h1>Quản lý yêu cầu hỗ trợ</h1>
                <div class="admin-user">
                    <span id="adminName">Admin</span>
                    <i class="fas fa-user-circle"></i>
                </div>
            </header>

            <!-- Stats Cards -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="stat-icon bg-warning">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="pendingCount">0</h3>
                            <p>Chờ xử lý</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="stat-icon bg-info">
                            <i class="fas fa-spinner"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="processingCount">0</h3>
                            <p>Đang xử lý</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="stat-icon bg-success">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="resolvedCount">0</h3>
                            <p>Đã giải quyết</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="stat-icon bg-secondary">
                            <i class="fas fa-archive"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="closedCount">0</h3>
                            <p>Đã đóng</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Filters -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-3">
                            <label class="form-label">Trạng thái</label>
                            <select class="form-select" id="statusFilter" onchange="loadSupportRequests()">
                                <option value="">Tất cả</option>
                                <option value="pending">Chờ xử lý</option>
                                <option value="processing">Đang xử lý</option>
                                <option value="resolved">Đã giải quyết</option>
                                <option value="closed">Đã đóng</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">Loại liên hệ</label>
                            <select class="form-select" id="typeFilter" onchange="filterRequests()">
                                <option value="">Tất cả</option>
                                <option value="individual">Cá nhân</option>
                                <option value="business">Doanh nghiệp</option>
                                <option value="creator">Người sáng tạo</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Tìm kiếm</label>
                            <input type="text" class="form-control" id="searchInput" 
                                   placeholder="Tìm theo tên, email, số điện thoại..." 
                                   onkeyup="filterRequests()">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Support Requests Table -->
            <div class="card">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Khách hàng</th>
                                    <th>Email</th>
                                    <th>Số điện thoại</th>
                                    <th>Loại</th>
                                    <th>Chủ đề</th>
                                    <th>Ngày gửi</th>
                                    <th>Trạng thái</th>
                                    <th style="min-width: 150px;">Thao tác</th>
                                </tr>
                            </thead>
                            <tbody id="supportRequestsTable">
                                <tr>
                                    <td colspan="9" class="text-center">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Đang tải...</span>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Pagination -->
                    <nav aria-label="Page navigation" class="mt-4">
                        <ul class="pagination justify-content-center" id="pagination">
                        </ul>
                    </nav>
                </div>
            </div>
        </main>
    </div>

    <!-- Request Detail Modal -->
    <div class="modal fade" id="requestDetailModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Chi tiết yêu cầu hỗ trợ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="requestDetailContent">
                    <!-- Content will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/admin-session.js"></script>
    <script src="js/admin-support.js"></script>
</body>

</html>
